/*
 */
(function(e,g){e.module("ugTree",["ugCommon"]).service("$tree",["$common","$timeout",function(b,f){var c={$config:{icon:{spin:"fa-spinner fa-spin",none:"fa-info-circle",close:"fa-caret-right",open:"fa-caret-down",unchecked:"fa-square-o",checked:"fa-check-square-o",ban:"fa-ban"}},collapse:function(a){b.valid.arr(a)?e.forEach(a,function(a){c.collapse(a)}):b.valid.obj(a)&&(c.$init(a),b.valid.undefined(a.$status.collapsed)?(b.valid.undefined(a.children)&&b.valid.fn(a.$fn.load)?c.$loadChildren(a):b.valid.undefined(a.children)&&
(a.children=[]),b.valid.defined(a.children)&&(a.$status.collapsed=!0)):!1===a.$status.collapsed?a.$status.collapsed=!0:!0===a.$status.collapsed&&(a.$status.collapsed=!1))},$loadChildren:function(a){b.valid.arr(a)?e.forEach(a,function(a){c.$loadChildren(a)}):b.valid.obj(a)&&b.valid.fn(a.$fn.load)&&(c.$init(a),a.$status.loading=!0,a.$fn.load(a),c.$checkLoadStatus(a),c.$init(a.children,a),c.collapse(a),a.$status.loading=!1)},$doOperation:function(a,d){if(b.valid.empty(a.$status.collapsed)||!1===a.$status.collapsed)c.collapse(a),
c.$checkLoadStatus(a);(d.fn||e.noop)(a)},$init:function(a,d){b.valid.arr(a)?e.forEach(a,function(a){c.$init(a,d)}):b.valid.obj(a)&&!0!==(a.$status||{}).inited&&(b.valid.undefined(a.$fn)&&(a.$fn={}),b.valid.undefined(a.$status)&&(a.$status={}),b.valid.undefined(a.$operations)&&(a.$operations=[]),b.valid.undefined(a.$parent)&&b.valid.obj(d)&&(a.$parent=d),a.$status.inited=!0)},$isFn:function(a){return b.valid.obj(a)&&b.valid.fn((a.$fn||{}).node)},$checkLoadStatus:function(a,d){d=d||0;f(function(){b.valid.undefined(a.children)&&
10>d?c.$checkLoadStatus(a,d++):10<=d&&console.log("cannot check node load status",a)},200)}};return c}]).directive("tree",["$common","$tree",function(b,f){return{restrict:"E",replace:!0,require:"^ngModel",scope:{ngModel:"=",autoCollapse:"="},templateUrl:b.ctrl.scriptPath(["ufrog-angular-tree.min.js","ufrog-angular-tree.js"])+"/ufrog-angular-tree.html",link:function(c,a){e.extend(c,{$init:function(){c.$wrap()},$wrap:function(){a.parent().is("li")||a.wrap('<div class="tree"></div>')},$collapseIcon:function(a){c.$service.$init(a);
if(!0===a.$status.loading)return c.$service.$config.icon.spin;if(b.valid.arr(a.children)&&0===a.children.length)return c.$service.$config.icon.none;if(b.valid.undefined(a.$status.collapsed)||!1===a.$status.collapsed)return c.$service.$config.icon.close;if(!0===a.$status.collapsed)return c.$service.$config.icon.open},$checkboxIcon:function(a){if(b.valid.undefined(a.$status.check)||"unchecked"===a.$status.check||"checked"===a.$status.check)return c.$service.$config.icon.unchecked;if("ban"===a.$status.check)return c.$service.$config.icon.ban},
$service:f}).$init()}}}])})(window.angular);
